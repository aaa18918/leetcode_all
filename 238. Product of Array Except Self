O(n) time, O(1) extra space excepts the output array
class Solution(object):
    def productExceptSelf(self, nums):
        """
        :type nums: List[int]
        :rtype: List[int]
        """
        
        size = len(nums)
        res = [1 for _ in range(size)]
        left, right = nums[0], nums[-1]
        for idx in range(1, size):
            res[idx] *= left
            left *= nums[idx]
            res[size-idx-1] *= right
            right *= nums[size-idx-1]
        
        return res
